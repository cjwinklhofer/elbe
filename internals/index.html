<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>ELBE technical Details • ELBE</title>
    <meta name="description" content="This article describes the qemu features ELBE is using.

">
    <meta name="keywords" content="">
    
      
    	<!-- Twitter Cards -->
	<meta name="twitter:title" content="ELBE technical Details">
	<meta name="twitter:description" content="This article describes the qemu features ELBE is using.

">
	
	
	
	<meta name="twitter:card" content="summary">
	<meta name="twitter:image" content="https://elbe-rfs.org/images/elbe-icon.png">
	
	<!-- Open Graph -->
	<meta property="og:locale" content="en_US.UTF-8">
	<meta property="og:type" content="article">
	<meta property="og:title" content="ELBE technical Details">
	<meta property="og:description" content="This article describes the qemu features ELBE is using.

">
	<meta property="og:url" content="https://elbe-rfs.org/internals/">
	<meta property="og:site_name" content="ELBE">

    <link rel="canonical" href="https://elbe-rfs.org/internals/">

    <link href="https://elbe-rfs.org/atom.xml" type="application/atom+xml" rel="alternate" title="ELBE Atom Feed">
    <link href="https://elbe-rfs.org/sitemap.xml" type="application/xml" rel="sitemap" title="Sitemap">

    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="320">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="cleartype" content="on">

    <link rel="stylesheet" href="https://elbe-rfs.org/css/main.css">
    <!-- HTML5 Shiv and Media Query Support for IE -->
    <!--[if lt IE 9]>
      <script src="https://elbe-rfs.org/js/vendor/html5shiv.min.js"></script>
      <script src="https://elbe-rfs.org/js/vendor/respond.min.js"></script>
    <![endif]-->

  </head>

  <body id="js-body">
    <!--[if lt IE 9]><div class="upgrade notice-warning"><strong>Your browser is quite old!</strong> Why not <a href="http://whatbrowser.org/">upgrade to a newer one</a> to better enjoy this site?</div><![endif]-->

    <header id="masthead">
  <div class="inner-wrap">
    <a href="https://elbe-rfs.org/" class="site-title"><img src="https://elbe-rfs.org/images/elbe-logo-small.png"></a>
    <nav role="navigation" class="menu top-menu">
        <ul class="menu-item">
	<li class="home"><a href="/">ELBE</a></li>
	
    
        
    
    <li><a href="https://elbe-rfs.org/download" >Download</a></li>
  
    
        
    
    <li><a href="https://elbe-rfs.org/docs" >Docs</a></li>
  
    
        
    
    <li><a href="https://elbe-rfs.org/support" >Support</a></li>
  
    
        
    
    <li><a href="https://elbe-rfs.org/devel" >Devel</a></li>
  
    
        
    
    <li><a href="https://elbe-rfs.org/imprint" >Imprint</a></li>
  
</ul>
    </nav>
  </div><!-- /.inner-wrap -->
</header><!-- /.masthead -->

    <nav role="navigation" id="js-menu" class="sliding-menu-content">
  <h5>ELBE <span>Table of Contents</span></h5>
  <ul class="menu-item">
    <li>
      <a href="https://elbe-rfs.org/download">
        
        <div class="title">Download</div>
        <p class="excerpt">Get Binary and Source packages</p>
      </a>
    </li><li>
      <a href="https://elbe-rfs.org/docs">
        
        <div class="title">Docs</div>
        <p class="excerpt">Documentation and man-pages</p>
      </a>
    </li><li>
      <a href="https://elbe-rfs.org/support">
        
        <div class="title">Support</div>
        <p class="excerpt">Community and commercial support</p>
      </a>
    </li><li>
      <a href="https://elbe-rfs.org/devel">
        
        <div class="title">Devel</div>
        <p class="excerpt">Development details</p>
      </a>
    </li><li>
      <a href="https://elbe-rfs.org/imprint">
        
        <div class="title">Imprint</div>
        <p class="excerpt">Imprint</p>
      </a>
    </li>
  </ul>
</nav>
<button type="button" id="js-menu-trigger" class="sliding-menu-button lines-button x2" role="button" aria-label="Toggle Navigation">
  <span class="nav-lines"></span>
</button>

<div id="js-menu-screen" class="menu-screen"></div>


    <div id="page-wrapper">
      <div id="main" role="main">
	<article class="wrap" itemscope itemtype="http://schema.org/Article">
		
		
		<div class="page-title">
			<h1>ELBE technical Details</h1>
		</div>
		<div class="inner-wrap">
			<div id="content" class="page-content" itemprop="articleBody">
				<p>This article describes the qemu features ELBE is using.</p>

<p>One essential point to understand is that qemu combines two
fundamentally different functionalities, which can also be used
independently and that ELBE uses both of them separately:</p>

<ul>
  <li>Virtualization (running a machine-in-a-machine)</li>
  <li>Emulation (running foreign machine-code)</li>
</ul>

<p>Both are traditionally used in combination (to run, for example, a full
ARM-based Android mobile device on an x86-based development machine).
ELBE, however, uses both functionalities separately, each one without
the other:</p>

<p>At the outside, ‘elbe initvm’ runs a full virtual machine with the host
system’s architecture, using the kvm technology. On a typical x86-based
host, this VM still runs x86 code at full efficiency, but does so in a
fully encapsulated environment, running its own kernel with virtualized
devices in it own root-file resides in a single file (buildenv.img) on
the hosts file system. This virtual machine must be booted before it can
be used and communication happens through its virtual console or through
virtual network connections.</p>

<p>At the inside, ‘elbe chroot’ runs a CPU emulation environment without
machine virtualization. This command actually does two separate things
at once:</p>

<ul>
  <li>
    <p>chroot - i.e. divert all child processes to view a certain directory
as their root. Within this directory, there is a full set of
subdirectories (/etc, /usr, /var, …) and the child processes cannot
see or access anything outside this directory.</p>
  </li>
  <li>
    <p>qemu-user-binfmt - i.e. register qemu in such a way that binaries of
the target architecture (e.g. ARM) are transparently called via qemu
(this fairly complex technique is documented e.g. on
https://wiki.debian.org/QemuUserEmulation)</p>
  </li>
</ul>

<p>The effect is that inside this ‘elbe chroot’ environment target .deb
packages can be deployed and target binaries executed. However, there is
not kernel running in the target architecture and the devices are still
those provided by the encapsulating initvm virtual machine.</p>

<p>While at the ‘elbe initvm’ boundary, the outside can only see a single
‘qemu’ process and a single ‘buildenv.img’ file, the ‘elbe chroot’
boundary is much more transparent, allowing the outside to observe
individual processes and files of the inner environment.</p>

				<hr />
				<footer class="page-footer">
					
	




<div class="author-content">
	<div class="author-name">
		Written by
		
			<span itemprop="author">Dr. Norbert Nemec</span>
		
	</div>
	<p class="author-bio"></p>
</div>

					<div class="page-meta">
	<p>Updated <time datetime="2015-12-14T00:00:00Z" itemprop="datePublished">December 14, 2015</time></p>
</div><!-- /.page-meta -->
				</footer><!-- /.footer -->
				<aside>
					
				</aside>
			</div><!-- /.content -->
		</div><!-- /.inner-wrap -->
		
	</article><!-- ./wrap -->
</div><!-- /#main -->

      <footer role="contentinfo" id="site-footer">
	<nav role="navigation" class="menu bottom-menu">
		<ul class="menu-item">
		
      
        
      
			<li><a href="https://elbe-rfs.org" ></a></li>
		
		</ul>
	</nav><!-- /.bottom-menu -->
	<p class="copyright">
		&#169; 2022
		<a href="https://elbe-rfs.org">ELBE</a> by
		<a href="https://linutronix.de">Linutronix GmbH</a> -
		ELBE is not affiliated with Debian, Debian is a registered trademark owned by SPI
	</p>
</footer>



    </div>

    <script src="https://elbe-rfs.org/js/vendor/jquery-1.9.1.min.js"></script>
    <script src="https://elbe-rfs.org/js/main.js"></script>

  </body>

</html>
