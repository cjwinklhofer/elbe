<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>ELBE 3 release • ELBE</title>
    <meta name="description" content="variant-management, SDK, ..">
    <meta name="keywords" content="">
    
      
    	<!-- Twitter Cards -->
	<meta name="twitter:title" content="ELBE 3 release">
	<meta name="twitter:description" content="variant-management, SDK, ..">
	
	
	
	<meta name="twitter:card" content="summary">
	<meta name="twitter:image" content="https://elbe-rfs.org/images/elbe-icon.png">
	
	<!-- Open Graph -->
	<meta property="og:locale" content="en_US.UTF-8">
	<meta property="og:type" content="article">
	<meta property="og:title" content="ELBE 3 release">
	<meta property="og:description" content="variant-management, SDK, ..">
	<meta property="og:url" content="https://elbe-rfs.org/news/v300/">
	<meta property="og:site_name" content="ELBE">

    <link rel="canonical" href="https://elbe-rfs.org/news/v300/">

    <link href="https://elbe-rfs.org/atom.xml" type="application/atom+xml" rel="alternate" title="ELBE Atom Feed">
    <link href="https://elbe-rfs.org/sitemap.xml" type="application/xml" rel="sitemap" title="Sitemap">

    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="320">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="cleartype" content="on">

    <link rel="stylesheet" href="https://elbe-rfs.org/css/main.css">
    <!-- HTML5 Shiv and Media Query Support for IE -->
    <!--[if lt IE 9]>
      <script src="https://elbe-rfs.org/js/vendor/html5shiv.min.js"></script>
      <script src="https://elbe-rfs.org/js/vendor/respond.min.js"></script>
    <![endif]-->

  </head>

  <body id="js-body">
    <!--[if lt IE 9]><div class="upgrade notice-warning"><strong>Your browser is quite old!</strong> Why not <a href="http://whatbrowser.org/">upgrade to a newer one</a> to better enjoy this site?</div><![endif]-->

    <header id="masthead">
  <div class="inner-wrap">
    <a href="https://elbe-rfs.org/" class="site-title"><img src="https://elbe-rfs.org/images/elbe-logo-small.png"></a>
    <nav role="navigation" class="menu top-menu">
        <ul class="menu-item">
	<li class="home"><a href="/">ELBE</a></li>
	
    
        
    
    <li><a href="https://elbe-rfs.org/download" >Download</a></li>
  
    
        
    
    <li><a href="https://elbe-rfs.org/docs" >Docs</a></li>
  
    
        
    
    <li><a href="https://elbe-rfs.org/support" >Support</a></li>
  
    
        
    
    <li><a href="https://elbe-rfs.org/devel" >Devel</a></li>
  
    
        
    
    <li><a href="https://elbe-rfs.org/imprint" >Imprint</a></li>
  
</ul>
    </nav>
  </div><!-- /.inner-wrap -->
</header><!-- /.masthead -->

    <nav role="navigation" id="js-menu" class="sliding-menu-content">
  <h5>ELBE <span>Table of Contents</span></h5>
  <ul class="menu-item">
    <li>
      <a href="https://elbe-rfs.org/download">
        
        <div class="title">Download</div>
        <p class="excerpt">Get Binary and Source packages</p>
      </a>
    </li><li>
      <a href="https://elbe-rfs.org/docs">
        
        <div class="title">Docs</div>
        <p class="excerpt">Documentation and man-pages</p>
      </a>
    </li><li>
      <a href="https://elbe-rfs.org/support">
        
        <div class="title">Support</div>
        <p class="excerpt">Community and commercial support</p>
      </a>
    </li><li>
      <a href="https://elbe-rfs.org/devel">
        
        <div class="title">Devel</div>
        <p class="excerpt">Development details</p>
      </a>
    </li><li>
      <a href="https://elbe-rfs.org/imprint">
        
        <div class="title">Imprint</div>
        <p class="excerpt">Imprint</p>
      </a>
    </li>
  </ul>
</nav>
<button type="button" id="js-menu-trigger" class="sliding-menu-button lines-button x2" role="button" aria-label="Toggle Navigation">
  <span class="nav-lines"></span>
</button>

<div id="js-menu-screen" class="menu-screen"></div>


    <div id="page-wrapper">
      <div id="main" role="main">
	<article class="wrap" itemscope itemtype="http://schema.org/Article">
		
		
  <nav class="breadcrumbs">
    <span itemscope itemtype="http://data-vocabulary.org/Breadcrumb">
      <a href="https://elbe-rfs.org" itemprop="url">
        <span itemprop="title">Home</span>
      </a> › 
    <span itemscope itemtype="http://data-vocabulary.org/Breadcrumb">
      <a href="https://elbe-rfs.org/news/" itemprop="url">
        <span itemprop="title">News</span>
      </a>
    </span>
  </nav><!-- /.breadcrumbs -->

		<div class="page-title">
			<h1>ELBE 3 release</h1>
		</div>
		<div class="inner-wrap">
			<div id="content" class="page-content" itemprop="articleBody">
				<p>All features of elbe-2.x and elbe-2.9.x are still available.
The XML format is compatible.</p>

<p>Debian packages for “ELBE 3” are available from linutronix.
Add sth. like this to your sources.list:</p>

<pre><code>deb http://debian.linutronix.de/elbe stretch main
</code></pre>

<h2 id="new-development-model">New development model</h2>
<p>Future development will be integrated into the ‘master’ branch of
github. There will be no longer “testing” releases of ELBE. The
next stable release will be “ELBE 4” and includes just one new
feature or bugfix.</p>

<p>The most important new features since ELBE 2.4 are described in the
following chapters.</p>

<h2 id="variant-management">Variant management</h2>
<p>Other build-systems allow building different flavours or variants of a
image based on some config values. This eases the maintainance of very
similar images.</p>

<p>A new parameter ‘–variant’ was added to the ‘initvm’ and ‘preprocess’
subcommand. A XML tag inside the XML file given to ‘preprocess’ can contain a
‘variant’ attribute. If the value of the variant attribute inside XML matches
with a variant given as parameter to the preprocess command, the XML tag
stays inside the XML file. If the XML tag has a variant attribute but
doesn’t match with the variant given as parameter to ‘preprocess’ the
XML tag will be dropped. If no ‘variant’ parameter is given to the
‘preprocess’ subcommand all tags with a ‘variant’ parameter are dropped.</p>

<p>This allows XML snippets like this:</p>

<pre><code>&lt;url variant='security'&gt;
        &lt;binary&gt;http://security.debian.org/ stretch/updates main&lt;/binary&gt;
        &lt;source&gt;http://security.debian.org/ stretch/updates main&lt;/source&gt;
&lt;/url&gt;
&lt;pkg-list&gt;
        &lt;pkg variant='security'&gt;openssh-server&lt;/pkg&gt;
        &lt;pkg variant='audio,video'&gt;totem&lt;/pkg&gt;
&lt;/pkg-list&gt;
</code></pre>

<p>It is also possible to use multiple sections with variant attributes like this:</p>

<pre><code>&lt;pkg-list variant='audio&gt;
        &lt;pkg&gt;alsa&lt;/pkg&gt;
        &lt;pkg&gt;pavucontrol&lt;/pkg&gt;
&lt;/pkg-list&gt;
&lt;pkg-list variant='video&gt;
        &lt;pkg&gt;totem&lt;/pkg&gt;
        &lt;pkg&gt;ffmpeg&lt;/pkg&gt;
&lt;/pkg-list&gt;
</code></pre>

<p>This needs defining mergeable sections by xpath.</p>

<p>This is the list of currently supported mergeable sections:
  - target/finetuning
  - target/pkg-list
  - project/buildimage/pkg-list</p>

<p>If one of these sections occure multiple times the contents are merged into a
single section.</p>

<p>If the above example will be submited by specifying</p>

<pre><code>elbe initvm submit --variant=audio,security'
</code></pre>

<p>It will use all elements but not</p>

<pre><code>&lt;pkg&gt;totem&lt;/pkg&gt;
&lt;pkg&gt;ffmpeg&lt;/pkg&gt;.
</code></pre>

<h2 id="archivedir">archivedir</h2>
<p>The new XML element ‘archivedir’ points to an local directory and adds
the content into a newly created archive. ‘archivedir’ can be
specified more then once. The content of the direcories is copied
in order of appearance. Existing files are overwritten by the later
ones. ‘archive’ and ‘archivedir’ are mutual exclusive.</p>

<p>‘archivedir’ is only allowed in XML files going into ‘elbe preprocess’ or
‘elbe initvm’ and are converted into an ‘archive’ tag by this elbe subcommands.</p>

<p>Example snippet to use ‘archivedir’:</p>

<pre><code>&lt;archivedir&gt;foo&lt;/archivedir&gt;
&lt;archivedir variant="production"&gt;bar&lt;/archivedir&gt;
&lt;archivedir keep-attributes="true"&gt;baz&lt;/archivedir&gt;
&lt;archivedir&gt;file:///overlay&lt;/archivedir&gt;
</code></pre>

<h2 id="sdk">SDK</h2>
<p>Currently only x86_64 host and armhf targets are supported.</p>

<pre><code>$ elbe initvm submit --keep-files --writeproject uuid.prj examples/armhf-ti-beaglebone-black.xml
$ elbe control build_sdk `cat uuid.prj`
$ elbe control wait_busy `cat uuid.prj`
$ mkdir -p sdk
$ elbe control --output sdk get_files `cat uuid.prj`
</code></pre>

<p>To use the SDK, follow the instructions from the
<a href="https://www.yoctoproject.org/docs/2.1/sdk-manual/sdk-manual.html#sdk-using-the-standard-sdk">Yocto SDK Manual (Chapter 2)</a></p>

<h2 id="docker">Docker</h2>
<p>It’s possible to run elbe inside a docker environment. ‘contrib/dockerfile’
inside the elbe source includes a Makefile for generating a Dockerfile and
running/stopping the container.</p>

<h2 id="debootstrap-specify-variant-add-extra-packages">debootstrap: specify variant, add extra packages</h2>
<p>ELBE 3 allows more specific control over debootstrapping the base system.</p>

<p>debootstrap variants are used to define, what is going to be
installed in a basic debian system. Known variants are:
 * minbase, which only includes essential packages and apt
 * buildd, which installs the build-essential packages into the rfs
 * fakechroot, which installs the packages without root privileges</p>

<p>E.g.</p>

<pre><code>&lt;debootstrapvariant&gt;minbase&lt;/debootstrapvariant&gt;
</code></pre>

<p>can now be used in an ELBE XML to specify the debootstrapvariant.</p>

<p>The debootstrapvariant element also allows an “includepkgs” attribute
to specify additional packages that should be installed during debootstrap.</p>

<h2 id="project-finetuning">Project finetuning</h2>
<p>Is a new finetung list that is executed after the images are created.
It supports converting an image into a different format, copy files from
or to a partition or setting a specific packer for an image. E.g.</p>

<pre><code>&lt;project-finetuning&gt;
  &lt;losetup img="sdcard.img"&gt;
    &lt;!-- globs work, but must make sure, that only a single file is matched --&gt;
    &lt;copy_from_partition part="1" artifact="vmlinuz"&gt;/vmlinuz-3.16.0-*-arm64&lt;/copy_from_partition&gt;
  &lt;/losetup&gt;
  &lt;img_convert fmt="qcow2" dst="sdcard.qcow2"&gt;sdcard.img&lt;/img_convert&gt;
  &lt;set_packer packer="tarxz"&gt;sdcard.qcow2&lt;/set_packer&gt;
&lt;/project-finetuning&gt;
</code></pre>

<h2 id="pbuilder-build-profiles">pbuilder: build-profiles</h2>
<p>dpkg-buildpackage allows to specify build profiles using -P option</p>

<p>Specifying a profile is now also supported by elbe by adding –profile to the
“elbe pbuilder” command.</p>

<h2 id="grubx86-support-for-uefi-incl-hybrid-boot">grub/x86: support for UEFI incl. hybrid boot</h2>
<p>It’s now possible to build x86 images with UEFI grub support. See
examples/x86_64-pc-hdimg-grub-hybrid-stretch.xml and
examples/x86_64-pc-hdimg-grub-uefi-stretch.xml for usage.</p>

<h2 id="elbe-debianize-supports-debianizing-u-boot">elbe-debianize: supports debianizing u-boot</h2>
<p>debianizing u-boot &gt;= 2014.04 is now supported by “elbe debianize”</p>

<h2 id="initvm-is-registered-at-libvirt">Initvm is registered at libvirt</h2>
<p>ELBE 2.x used a tmux session to run the initvm in the background. In ELBE 3
this was replaced by registering the initvm at libvirtd. “elbe initvm” now
uses the python libvirt bindings to control the initvm. There is still a
Makefile next to the initvm image to start/stop the initvm without using
libvirt.</p>

<h2 id="upgradedowngrade-version-of-elbe-inside-the-initvm">Upgrade/downgrade version of elbe inside the initvm</h2>
<p>‘elbe control install_elbe_version [version]’ makes the initvm install a
specific elbe version. It defaults to the version of the elbe executable used
to issue the command.</p>

<h2 id="source-code-cleanups">Source-code cleanups</h2>
<p>Elbe now uses SPDX licence tags.
It follows the pep8 codingy-style.
And a lot of pylint complains have been fixed.</p>

				<hr />
				<footer class="page-footer">
					
	



<div class="author-image">
	<img src="http://www.gravatar.com/avatar/565400ba01d843cced55bdc159f310ad?s=150" alt="Manuel Traut">
</div>


<div class="author-content">
	<div class="author-name">
		Written by
		
			<span itemprop="author">Manuel Traut</span>
		
	</div>
	<p class="author-bio"></p>
</div>

					<div class="page-meta">
	<p>Updated <time datetime="2019-03-14T00:00:00Z" itemprop="datePublished">March 14, 2019</time></p>
</div><!-- /.page-meta -->
				</footer><!-- /.footer -->
				<aside>
					
				</aside>
			</div><!-- /.content -->
		</div><!-- /.inner-wrap -->
		
	</article><!-- ./wrap -->
</div><!-- /#main -->

      <footer role="contentinfo" id="site-footer">
	<nav role="navigation" class="menu bottom-menu">
		<ul class="menu-item">
		
      
        
      
			<li><a href="https://elbe-rfs.org" ></a></li>
		
		</ul>
	</nav><!-- /.bottom-menu -->
	<p class="copyright">
		&#169; 2022
		<a href="https://elbe-rfs.org">ELBE</a> by
		<a href="https://linutronix.de">Linutronix GmbH</a> -
		ELBE is not affiliated with Debian, Debian is a registered trademark owned by SPI
	</p>
</footer>



    </div>

    <script src="https://elbe-rfs.org/js/vendor/jquery-1.9.1.min.js"></script>
    <script src="https://elbe-rfs.org/js/main.js"></script>

  </body>

</html>
